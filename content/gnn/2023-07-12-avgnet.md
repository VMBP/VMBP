---
title: "AvgNet"
date: 2023-07-12T14:49:19+08:00
draft: false
summary: "在我们的数字世界中，充满了各种时序和图形数据，这些数据捕获了许多复杂系统的各种方面。所以 AvgNet 是啥？"
author: "Zambon21"
---

## 摘要
在我们的数字世界中，充满了各种时序和图形数据，这些数据捕获了许多复杂系统的各种方面。传统上，处理这两种不同类型的数据有各自的方法，例如，循环神经网络（RNN）和图神经网络（GNN）。近年来，使用像可视化图（VG）这样的技术，可以将时序数据映射到图上，这种方法可以同时以简单的方式捕获局部和全局动态的相关方面，这样，研究人员就可以使用图算法来挖掘时序数据中的知识，并获取特殊的潜在图表示特征。这种映射方法在时序和图之间建立了一座桥梁，具有促进对各种实际时序数据分析的巨大潜力。然而，VG方法及其变体仅基于固定规则，因此缺乏灵活性，大大限制了它们在现实中的应用。在本文中，我们提出了一个自适应可视化图（AVG）算法，可以根据需要自适应地将时序数据映射到图上。基于此，我们进一步建立了一个端到端的分类框架AvgNet，通过利用GNN模型DiffPool作为分类器。然后，我们采用AvgNet进行无线电信号调制分类，这是无线通信领域的一个重要任务。模拟验证表明，AvgNet超越了一系列先进的深度学习方法，在这个任务中取得了最先进的性能。

### I. 引言
图和时间序列是现实世界中的两种典型数据。前者被用来描述许多复杂系统的拓扑结构，其中的节点代表子系统，而链接则捕获它们之间的关系，从而导致复杂网络的出现[1]，[2]；而后者则被用来捕捉这些系统的时间动态。目前，生物学、社会科学、计算机科学等学科中都存在丰富的图数据[3]-[5]，使得研究者们可以充分利用网络分析技术来解决对应领域中的相关问题。例如，在生命科学领域，生物分子间存在相互作用，基于这种作用可以建立复杂的生物网络，从而预测分子属性[6]，[7]。在社会科学中，网络社交平台的发展使信息的传播比以往任何时候都要方便，但随之而来的也是虚假新闻的广泛传播。幸运的是，通过引入图数据挖掘技术，我们可以检测并过滤虚假信息，一定程度上净化网络环境[8]，[9]。在网络科学领域，图分类是图数据挖掘任务中的一个重要部分。代表性的图分类方法可以分为三种类型，第一种是基于随机漫步[10]、路径[11]和子树[12]的图核方法；第二种是图嵌入方法，如subgraph2vec[13]和graph2vec[14]；最后一种是深度学习方法，即图神经网络(GNNs)，典型的包括动态图卷积神经网络(DGCNN)[15]、DiffPool[16]和SAGPool[17]。

对于时间序列，这里我们主要关注无线电信号的调制分类[18]-[21]。近年来，随着深度学习的快速发展，一些神经网络模型被引入到这个领域[22]-[24]。Hong等人[25]提出了一个基于两层门控递归单元(GRU)网络的分类模型。Rajendran等人[26]提出了一个用于自动调制分类的两层长短期记忆(LSTM)模型，该模型具有相当的准确性，但相对耗时。一些研究者将时间序列映射为矩阵，然后使用卷积神经网络(CNNs)进行分类[23]，[27]。例如，Wang等人[28]通过采用Gramian Angular Fields (GAF)和Markov Transition Fields (MTF)将时间序列转换为矩阵。Peng等人[27]获取了信号的星座图，然后使用典型的CNN进行分类。然而，由于这些方法的映射规则是固定的，它们可能不够灵活。O'Shea等人[29]将每个无线电信号视为宽度为2的单通道图像，并使用2个卷积层和2个全连接层进行调制分类，我们在本文中将这种方法称为CNN2D，并将其作为比较的基线。此外，O'Shea等人[30]还使用了一种残差神经网络进行调制分类，即CNN1D。最近，Xu等人[31]提出了一个多通道CNN，名为MCLDNN，使用不同的卷积特征。Chen等人[32]采用了一个联合训练的信号-矩阵操作符结合CNN架构进行分类。除了在时间域中提取特征，Zeng等人[33]使用频域特征的频谱图来帮助分类。值得注意的是，由于GNN[34]-[37]和有效的图映射方法的巨大成功，首先将时间序列映射为图，然后利用强大的GNN进行分类，也将是一个激动人心的方向。图是一种更普遍的形式，它可以表示采样点之间的关系，而不仅仅是时间关系。从图的角度来看，可能可以提取出CNN/RNN在时间序列中难以获取的潜在特征。Lacasa等人[38]提出了Visibility Graph (VG)算法将时间序列转换为图，然后出现了许多VG的变体。在VG分析中，每个采样点被视为一个节点，每个边都由相应的可视性标准推断出来，这将在第二节中详细讨论。基于VG，Luque

等人[39]引入了Horizontal Visibility Graph (HVG)，一种具有更简单规则和更少统计数据的映射算法。Gao等人[40]通过引入一些不满足可视性标准的有限边来抵抗噪声，提出了Limited Penetrable Visibility Graph (LPVG)，并在油气水三相流的分类中取得了好的结果。Xuan等人[41]首次在VG的构建中引入了圆形系统，提出了Circular Limited Penetrable Visibility Graph (CLPVG)，并在无线电调制分类中通过图嵌入技术实现了比LPVG更高的准确率。调制信号由调制符号组成，每个调制符号内的局部特征和调制符号之间的全局特征对调制识别有着重要的影响。在VG中，可以以简单直观的方式捕获和处理局部和全局动态特征的相关方面，这非常适合于调制识别。然而，几乎所有这些技术都根据固定的规则将时间序列映射为图，特别是全局特征和局部特征的关注程度不能进行调整，而且在训练过程中图的结构不会改变。显然，我们不能保证图的结构是合理的，因此缺乏应对复杂任务的灵活性。因此，我们希望图的结构在一定程度上是可学习的。

在本文中，我们专注于提出一个用于信号分类的端到端图神经网络（GNN）框架。特别地，我们首先介绍自适应可视图（AVG），它可以通过一些神经网络层将信号自适应地映射为图，从而避免上述映射算法的不灵活性。然后，我们将AVG与修改后的DiffPool [16]（一种原本用于图分类的典型GNN模型）结合，形成一个端到端的分类框架，我们称之为AvgNet。不同于现有的固定映射技术，我们的框架可以自动且适应地将信号样本转换为相应的最佳匹配图，这不仅大大减少了映射过程中的时间消耗，而且可以聚集信号样本的局部和全局信息。本文的主要贡献如下所示。

- 我们提出了AVG，它可以根据特定任务自动且适应性地将信号映射为图。通过这种机制，我们可以尽可能保留原始信号的局部和全局信息，并通过分析图拓扑特征来挖掘无线电信号中的隐含时间信息。
- 我们通过整合AVG和修改后的DiffPool，提供了一个用于无线电信号调制分类的端到端GNN框架，即AvgNet。在这种设置中，AVG可以与DiffPool一起训练，并自适应地学习获取当前信号最适合的图，以显著提高分类模型的效率和有效性。
- 我们在无线电信号领域的两个公共数据集RML2016.10a和RML2016.10b上测试了我们的方法，结果验证了AvgNet的有效性，即它超越了RNN、CNN和传统VG模型，实现了最先进的性能。

本文的其余部分结构如下。第二部分介绍AVG以及如何将其与DiffPool结合以构建我们的端到端深度学习框架AvgNet。第三部分提供数据集、仿真设置、基线，并同时总结和讨论仿真结果。最后，第四部分对论文进行总结。

### II. 方法

#### A. 信号到图的映射
在无线电信号被发送之前，基带信号必须被调制，比如幅度调制，频率调制，和相位调制。接收器需要知道其调制类型来解调原始信号，这就是调制识别任务。调制识别任务可以被看作是一个分类问题，可以被表述为一个$M$元素假设测试问题。令调制类型的集合为标签 $=\{1,2 \ldots, M\}$，其中 $M$ 代表类别数量。那么信号$T_{n o w}$的调制类型可以被表达为
$$
\gamma\left(T_{\text {now }}\right)=k, k \in \text { Label }
\tag{1}
$$
其中$\gamma\left(T_{\text {now }}\right)$表示信号$T_{\text {now }}$的调制类型。
为了在无线电信号调制分类的领域使用图分类模型，我们首先需要将信号转化为图形。到目前为止，Lacasa等人[38]提出了自然可视化图（VG）算法，用于将时间序列映射到图形中，从新的角度分析时间序列，其过程如图1所示。他们的实验显示，构建的图在其结构中继承了序列的几个属性。在此基础上，Luque等人[39]提出了改进的映射算法，水平可视化图（HVG），而Gao等人[40]进一步引入了有限穿透视图（LPVG）。我们以VG为例简单介绍其映射信号到图的规则。给定一个信号$T$
$$
T=\left[T_1, T_2, \ldots, T_n\right],
\tag{2}
$$
其中$n$代表$T$的长度，即采样点的数量，$T_n$代表对应采样时间点$n$的信号值。VG将所有采样点视为最终映射图的节点，然后确定每两个采样点是否可以形成一条边。例如，对于采样点$\left(i, T_i\right)$和$\left(j, T_j\right)$，如果满足以下条件，这两个节点可以形成一条边：
$$
T_u<\frac{\left(T_j-T_i\right) \times(u-j)}{(j-i)}+T_j, i<u<j
\tag{3}
$$
VG将信号映射到相应图的具体过程如图1所示。可以看到，节点3和4对应的信号值都在由采样点$\left(2, T_2\right)$和$\left(5, T_5\right)$形成的线段下方，所以节点2和5可以形成一条边。相反，节点3和6不能形成一条边，因为它们之间的采样点$\left(4, T_4\right)$或$\left(5, T_5\right)$在它们的线段之上。

总的来说，上述映射方法的唯一区别是它们的固定映射规则。尽管所有这些映射算法都可以将时间序列样本映射到图中，以便将图领域的知识合理引入到时间序列问题的下游任务中，但无可否认的是，这些映射算法都需要判断每两个采样点是否可以形成图的一条边，这是相对低效的，所需的映射时间随着时间序列长度的增加而倍增。此外，这些映射方法相对僵化，只能基于已建立的规则建立图，缺乏灵活性。

为了解决上述问题，并在映射过程中尽可能保留原始信号的信息，并进一步提高映射效率，我们在上述现有映射方法[38]-[40]的基础上，提出了自适应可视图(AVG)算法。AVG可以通过一维卷积将时间序列转化为图形，然后可以与典型的图分类模型一起进行训练。一般来说，这个算法的具体过程如图2和算法1所示。对于公式(2)中显示的时间序列$T$，我们的目标是将其映射到图$G=$ $\langle V, E\rangle$，其中$V$和$E$分别代表图$G$的节点集和边集。首先，我们使用$m-1$个一维卷积算子Conv $\_s$，不同的卷积核长度$s \in$ $[2, m]$来处理$T$。得到的$T$的特征序列可以通过以下方式计算：

$$
\varphi_s^T=\operatorname{Conv}_s(T), s \in[2, m]
\tag{4}
$$

其中 $\operatorname{Conv}\_s(\cdot)$ 是一个卷积核长度为$s$，步长为1的一维卷积层，$\varphi_s^T$是一个向量，表示为
$$
\varphi_s^T=\left[B_1^s, B_2^s, \ldots, B_{n+1-s}^s\right], s \in[2, m] .
\tag{5}
$$
在此，$m$是一个超参数，用于限制两个时间采样点之间的距离，可以被看作是本地信息提取。之后，我们使用非线性激活函数ReLU [42]来处理$\varphi_s^T$，其中ReLU可以类似于在那里过滤噪声的操作。过程可以表示为
$$
\begin{aligned}
\phi_s^T & =\operatorname{Re} L U\left(\varphi_s^T\right) \\
& =\left[F_1^s, F_2^s, \ldots, F_f^s, \ldots, F_{n+1-s}^s\right], s \in[2, m] .
\end{aligned}
\tag{6}
$$
因此，公式 (2) 中所示的一维时间序列 $T$ 可以通过将卷积获得的特征序列沿对角平行方向排列映射成图 $G=\langle V, E\rangle$，这可以用一个 $n * n$ 的特征矩阵 $M_T$ 表达：
$$
M_T=\left[\begin{array}{cccccccc}
0 & F_1^2 & F_1^3 & \cdots & F_1^m & 0 & \cdots & 0 \\\\\\
F_1^2 & 0 & F_2^2 & F_2^3 & \cdots & F_2^m & \ddots & \vdots \\\\\\
F_1^3 & F_2^2 & 0 & F_3^2 & F_3^3 & \ddots & \ddots & 0 \\\\\\
\vdots & F_2^3 & F_3^2 & 0 & F_4^2 & F_4^3 & \ddots & F_{n+1-m}^m \\\\\\
F_1^m & \vdots & F_3^3 & F_4^2 & 0 & F_5^2 & \ddots & \vdots \\\\\\
0 & F_2^m & \ddots & F_4^3 & F_5^2 & 0 & \ddots & F_{n-2}^3 \\\\\\
\vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & F_{n-1}^2 \\\\\\
0 & \cdots & 0 & F_{n+1-m}^m & \cdots & F_{n-2}^3 & F_{n-1}^2 & 0
\end{array}\right]
\tag{7}
$$
其中，$F_i^j$ 表示节点 $i$ 和 $j$ 的边权重。

一般来说，AVG算法的灵感来源于VG算法，并在其基础上提出。在确定两个信号采样点是否可以构建一个边时，VG算法首先会根据这两个采样点的信号值建立一个形如 $y=k x+b$ 的线性函数，然后检查其中间的信号值是否都在直线之下，如图1所示。这样的过程可能会忽略掉中间的具体信号值，这必然会导致一些信息的丢失。相比之下，我们提出的AVG算法在判断两个信号点是否可以形成图的一条边时，可以通过一维卷积层充分利用这两点以及其中间时间点对应的信号值。特别的，AVG算法中的一维卷积操作与VG算法中涉及的线性函数类似，它被用来测量滑动信号段与卷积操作符之间的关联性，作为一个重要的时间特性。注意到，信号段的最大长度可以由公式 (4) 中的超参数 $m$ 限制，这表明两个时间间隔大于 $m$ 的信号采样点不能形成一条边，因为在时间序列中，相距较远的两个时间采样点的时间信息并不如接近的那些重要。通过关注信号的局部相关性，我们也可以提高映射效率。并且，AVG的时间复杂度是 $O(n \cdot m)$，而VG的时间复杂度是 $O\left(n^2\right)$。同时，VG方法通过判定语句推断边，这不能被GPU加速，而AVG是矩阵操作。因此，AVG算法可以有效地保留时间序列中尽可能多的信息，这对后续的分类任务有益。

#### B. 结合GNN的分类

通过提出的AVG算法将无线电信号映射成图，我们可以结合用于图分类的典型GNN模型，获得一个用于无线电信号调制分类的神经网络框架。这种分类框架可以借助一维卷积大大提高映射效率，并具有出色的分类效果。在本文中，我们从现有的GNN领域的图分类模型中选择了DiffPool。值得注意的是，DiffPool除了需要输入图的邻接矩阵或特征矩阵外，还需要每个节点的特征向量，而且层次化的池化结构与调制信号由调制符号组成的特性是一致的。一方面，对于公式（2）中显示的常见的单变量时间序列，我们可以通过AVG得到映射图的特征矩阵，并将节点对应的采样点的信号值作为节点的特征序列，这样我们就可以直接将AVG和DiffPool组合成一个分类模型来实现时间序列分类。另一方面，对于本文研究的无线电信号，这是典型的多变量时间序列，我们需要处理DiffPool以分类输入的多通道样本。每个信号样本由通道I和通道Q组成，让两个通道表示为
$$
\begin{aligned}
I & =\left[I_1, I_2, \ldots, I_j, \ldots, I_n\right], \\
Q & =\left[Q_1, Q_2, \ldots, Q_j, \ldots, Q_n\right] .
\end{aligned}
\tag{8,9}
$$
我们使用AVG算法将每个信号样本的通道I和通道Q分别映射成它们对应的图 $G_I=$ $\left\langle V_I, E_I\right\rangle$ 和 $G_Q=\left\langle V_Q, E_Q\right\rangle$，也就是说，通过
$$
\begin{aligned}
\phi_s^I & =\operatorname{Re} L U\left(\operatorname{Conv}_s(I)\right) \\
& =\left[J_1^s, J_2^s, \ldots, J_{n+1-s}^s\right], s \in[2, m], \\
\phi_s^Q & =\operatorname{Re} L U\left(\operatorname{Conv}_s(Q)\right) \\
& =\left[P_1^s, P_2^s, \ldots, P_{n+1-s}^s\right], s \in[2, m],
\end{aligned}
\tag{10,11}
$$
得到映射图的特征矩阵 $M_I$ 和 $M_Q$，其中 $M_I$ 和 $M_Q$ 可以表示为
$$
M_I=\left[\begin{array}{cccccccc}
0 & J_1^2 & J_1^3 & \cdots & J_1^m & 0 & \cdots & 0 \\
J_1^2 & 0 & J_2^2 & J_2^3 & \cdots & J_2^m & \ddots & \vdots \\
J_1^3 & J_2^2 & 0 & J_3^2 & J_3^3 & \ddots & \ddots & 0 \\
\vdots & J_2^3 & J_3^2 & 0 & J_4^2 & J_4^3 & \ddots & J_{n+1-m}^m \\
J_1^m & \vdots & J_3^3 & J_4^2 & 0 & J_5^2 & \ddots & \vdots \\
0 & J_2^m & \ddots & J_4^3 & J_5^2 & 0 & \ddots & J_{n-2}^3 \\
\vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & J_{n-1}^2 \\
0 & \cdots & 0 & J_{n+1-m}^m & \cdots & J_{n-2}^3 & J_{n-1}^2 & 0
\end{array}\right]
\tag{12}
$$
$$
M_Q=\left[\begin{array}{cccccccc}
0 & P_1^2 & P_1^3 & \cdots & P_1^m & 0 & \cdots & 0 \\
P_1^2 & 0 & P_2^2 & P_2^3 & \cdots & P_2^m & \ddots & \vdots \\
P_1^3 & P_2^2 & 0 & P_3^2 & P_3^3 & \ddots & \ddots & 0 \\
\vdots & P_2^3 & P_3^2 & 0 & P_4^2 & P_4^3 & \ddots & P_{n+1-m}^m \\
P_1^m & \vdots & P_3^3 & P_4^2 & 0 & P_5^2 & \ddots & \vdots \\
0 & P_2^m & \ddots & P_4^3 & P_5^2 & 0 & \ddots & P_{n-2}^3 \\
\vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & P_{n-1}^2 \\
0 & \cdots & 0 & P_{n+1-m}^m & \cdots & P_{n-2}^3 & P_{n-1}^2 & 0
\end{array}\right]
\tag{13}
$$
接着，我们将图 $G_I$ 和 $G_Q$ 各自节点 $j$ 的特征向量设定为 $\left[I_j, Q_j\right]$，然后使用去掉最后一层全连接层的改良版 DiffPool 分别处理图 $G_I$ 和 $G_Q$，得到它们各自的特征向量 $C_I$ 和 $C_Q$ :
$$
\begin{aligned}
C_I & =\left[C_1^I, C_2^I, \cdots\right], \\
C_Q & =\left[C_1^Q, C_2^Q, \cdots\right] .
\end{aligned}
\tag{14,15}
$$
通过以下公式将特征序列 $C_I$ 和 $C_Q$ 合并为 $C_{I Q}$：
$$
\begin{aligned}
C_{I Q} & =\text { concatenate }\left\langle C_I, C_Q\right\rangle \\
& =\left[C_1^I, C_2^I, \ldots, C_1^Q, C_2^Q, \cdots\right]
\end{aligned}
\tag{16}
$$
我们加入一个新的全连接层进行分类。最终，我们得到了一个名为 Adaptive Visibility Graph GNN Framework（AvgNet）的分类模型，用于对无线电信号进行分类。

显然，与现有的传统可视映射算法相比，我们的 AVG 映射算法可以与典型的 GNN 一起训练，形成一个端到端的调制信号分类模型。该模型能够通过神经网络训练来学习如何将无线电信号映射到更合适的图上。通过将信号映射到图上然后进行分类，信号数据的时间信息可以通过图的拓扑结构得到完全保留。此外，我们可以通过图的特征矩阵，即像 $M_I$ 这样的边权重矩阵，来表达图节点对应的时间采样点之间的关联程度。同时，我们还能够借助映射图节点的特征向量，保留原始信号数据中时间采样点的信号值。

## C. 整体框架
AvgNet的整体框架如图3所示。通过AVG算法，我们可以将I和Q通道的信号数据分别映射到图 $G_I$ 和 $G_Q$ 上。设定图 $G_I$ 和 $G_Q$ 节点的特征向量后，我们使用改良版的DiffPool，一个典型的图分类GNN模型，分别处理图 $G_I$ 和 $G_Q$ ，并得到相应的特征向量 $C_I$ 和 $C_Q$ 。在拼接 $C_I$ 和 $C_Q$ 得到 $C_{I Q}$ 后，我们可以通过一个全连接层处理 $C_{I Q}$ 来实现分类的目标。

总的来说，通过将AVG算法与修改过的DiffPool结合，我们可以得到用于无线电信号调制分类的AvgNet模型。特别是，将信号映射到图和图分类部分一起训练，可以确保所得图更适合原始信号。因此，我们的AvgNet模型可以尽可能地保留原始信号中的信息，并挖掘出潜在的信息以提高分类精度。

# III. 实验

## A. 数据集
在本文中，我们使用两个公开的无线电信号数据集 RML2016.10a [29] 和 RML2016.10b [43] 来测试我们的分类模型AvgNet。
其中，RML2016.10a 共有220,000个信号样本，包括11种调制类型的 8PSK，AM-DSB，AM-SSB，BPSK，CPFSK，GFSK，P4AW，QAM16，QAM64，QPSK 和 WBFM。每种调制类型有从 $-20 \mathrm{~dB}$ 到 $18 \mathrm{~dB}$ ，以 $2 \mathrm{~dB}$ 间隔的20个信噪比(SNRs)级别。每个信号样本长度为128，由两个通道 I 和 Q 组成。在模拟中，我们按照 $4:1$ 的比例划分训练集和测试集。为确保样本数量的平衡，我们从每种调制模式的每个 SNR 的信号数据中随机选择 $80 \%$ 作为训练集，其余的作为测试集。最后，训练集中有176,000个信号样本，测试集中有44,000个信号样本。

此外，数据集 RML2016.10b 有1.2百万个样本，包含10种调制类型，即 8PSK，AMDSB，BPSK，CPFSK，GFSK，PAM4，QAM16，QAM64，QPSK 和 WBFM。同样，该数据集有20个SNRs级别和长度为128。在模拟中，我们按照 [29] 中的开源方法划分这个数据集，也就是说，我们将随机种子值设为2016，然后以 1:1 的比例随机划分为训练集和测试集。

## B. 模拟设置
对于我们的方法和所有基线，我们使用相同的学习策略和环境，所有基线模型均源自他们的参考文献。在模拟中，我们使用交叉熵损失函数和Adam [44] 优化器。批量大小和学习率的初始值分别设置为128和0.001，每10个训练批次，学习率降低到前一个值的 $80 \%$。此外，我们提出的模型AvgNet中在(5)中提到的超参数 $m$ 设为11。所有模拟都在基于PyTorch深度学习框架 [45] 的NVIDIA Tesla V100上运行。更进一步，我们使用PyTorch Geometric [46]，一个PyTorch的几何深度学习扩展库，来构建我们的AvgNet模型中的DiffPool神经网络层。

## C. 基线和设置
我们将AvgNet与三种不同类型的基线进行比较。第一种是使用RNN模型对信号进行分类，具体来说，我们使用了第一部分中提到的GRU [25] 和LSTM [26]，这些模型直接输入原始的IQ无线电信号。第二种是借助CNN模型对无线电信号进行分类。在模拟中，我们主要使用第一部分中提到的GAF，MTF [28]，CD [27]，CNN2D [29]，CNN1D [30]，MCLDNN [31] 和SigNet [32]。特别是，GAF，MTF和CD会先将每个长度为128的IQ无线电信号映射成一个$2 \times 128 \times 128$的双通道图像，然后使用典型的ResNet50模型进行分类。对于SigNet，我们按照参考文献中的设置，设定模型在信号到矩阵操作中使用2个形状为$3 \times 3$的滤波器和1个步长，所以每个长度为128的IQ无线电信号将被转换成一个$2 \times 126 \times 126$的双通道图像，然后这些图像也将导入到同样的ResNet50中。最后一种是通过VG映射方法将信号转换成固定转换规则的图，然后通过分类相应的图对信号进行分类。在映射方法中，我们选择了第二部分A部分中描述的典型方法VG和LPVG。根据VG，LPVG和AVG的详细信息，每个长度为128的IQ无线电信号将被转换成一个带有128个节点的双通道图。为了确保比较的公平性，我们也使用AvgNet中修改后的DiffPool对获得的图进行分类。

## D. 结果与讨论
首先，我们简要讨论了公式(5)中提到的超参数$m$对分类准确度的影响。在不同的超参数$m$情况下，AvgNet在两个数据集上的分类准确度如图4所示。可以看到，当$m$等于11时，AvgNet在两个数据集上的分类准确度最好。

接着，我们主要比较了AvgNet与不同类型基线在无线电信号数据集上的分类效果。我们在RML2016.10a和RML2016.10b数据集上用所有方法得到的分类结果如精确度、F1分数和召回率分别在表I和表II中显示，而他们在对应测试集不同SNR上的分类精度分别在图5(a)和5(b)中展示。我们首先将AvgNet与用于无线电信号调制分类的典型RNN模型GRU和LSTM进行比较。从表I和图5(a)可见，AvgNet在精确度、F1分数和召回率上都优于GRU和LSTM。而且，AvgNet在每个SNR上的分类精度都高于GRU和LSTM。此外，AvgNet也优于如GAF，MTF，CD，CNN2D和CNN1D等CNN方法。值得注意的是，AvgNet中使用的DiffPool和GAF，MTF和CD中使用的ResNet50都是在图像和图形领域的典型深度学习分类模型。他们在各自的领域都有良好的分类性能。在一定程度上，这可以解释为，与映射信号到图像相比，映射信号到图形可以帮助我们更好地捕获信号的潜在特征，从而提高信号分类的精确度。最后，通过将AvgNet与典型的图映射方法VG和LPVG进行比较，这两种方法都使用修改后的DiffPool来对映射图进行分类，我们可以发现AVG优于具有固定转换规则的VG和LPVG。换句话说，AVG可以通过端到端的训练学习到信号更适合的图，从而得到更好的分类性能。总的来说，我们提出的AvgNet在所有比较的方法中具有最好的分类性能，并且模型大小合理。此外，对于另一个数据集RML2016.10b，我们也可以通过表II和图5(b)得到同样的结论，表明我们的AvgNet具有强大的泛化能力。

为了更详细地比较这些不同方法的分类性能，我们在RML2016.10a和RML2016.10b数据集上画出他们的混淆矩阵，如图6(a)和6(b)所示。在RML2016.10a数据集上，所有方法都倾向于将其他调制类型误分类为AM-SSB。除AvgNet外，其他分类方法更可能混淆调制类型QAM16和QAM64。除了GAF，MTF和CD，其他方法都容易将WBFM误分类为AM-DSB。在RML2016.10b数据集上，所有方法都容易将WBFM误认为AM-DSB，此外，将信号映射为图像的GAF，MTF和CD更可能将其他调制类型误分类为AM-DSB。与其他方法相比，CNN1D，GRU，LSTM和AvgNet在区分QAM16和QAM64方面有更好的能力。

此外，调查AvgNet中AVG生成的图也非常有趣。我们随机选择两个数据集中每种调制类型的高SNR I通道信号，并绘制他们相应的图，如图7(a)和7(b)所示。这些图是由Gephi [47]绘制的，布局是OpenOrd [47]。为了使不同类别的图看起来更明显，我们移除了每个图中非常小的边，并使用渐变色来区分边的权重。根据图7(a)，在RML2016.10a数据集上，我们发现从不同调制类型的信号映射过来的大部分图呈现出不同的结构，这有利于识别无线电信号的调制类型。此外，我们也可以看到，虽然一些对应不同调制类型的图在结构上相似，如QAM64和QAM16，8PSK和BPSK

我们的AvgNet仍然可以很好地区分它们，因为AvgNet中使用的GNN模型DiffPool的输入不仅包含表示图结构的邻接矩阵，而且还包含图中每个节点的特征向量。同样，根据图7(b)，我们可以在RML2016.10b数据集上找到类似的情况。映射自调制类型QAM64和QPSK的图在结构上相似，但我们仍然可以很好地区分它们。此外，由于训练集中的数据类型和数据量不同，同一调制类型的图可能会显示出不同的结构。总的来说，我们在AvgNet中设置了基于I和Q通道信号值的映射图的节点特征向量，然后通过生成图的结构充分利用它们。在这个意义上，我们的AvgNet可以作为一个整体全面地考虑原始信号的局部和全局信息，从而导致其出色的分类性能。
